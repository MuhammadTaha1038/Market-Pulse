{
  "CLO_US_CLO": {
    "name": "CLO_US_CLO",
    "enabled": true,
    "columns": {},
    "oracle_query": "WITH SEC_MASTER AS (\n    SELECT MASTER.SEC_ID,\n           MASTER.SEC_ID_TYPE,\n           FIELD_NAME,\n           CASE\n               WHEN FIELD_TYPE = 'String' THEN FIELD_STRING_VALUE\n               WHEN FIELD_TYPE = 'Integer' THEN TO_CHAR(FIELD_INTEGER_VALUE)\n           END AS FIELD_VALUE\n    FROM SECURITY_MASTER MASTER\n    LEFT JOIN SEC_INDICATIVE_INFO DEAL\n        ON DEAL.SEC_ID = MASTER.SEC_ID\n        AND DEAL.SEC_ID_TYPE = MASTER.SEC_ID_TYPE\n        AND DEAL.FIELD_NAME IN ('DealType', 'Currency', 'OriginalBestRatingScore', 'MkTicker')\n    WHERE prc_config_sec_type = 'CLO'\n        AND prc_CONFIG_KEY_NAME NOT IN ('All', 'CDO', 'CDO_Flat', 'TruPS', 'CRT')\n        AND sec_status = 'Approved'\n--        AND prc_CONFIG_KEY_NAME IN ('US_Equity_2.0', 'US_Equity_1.0')\n),\nCLO_LIST AS (\n    SELECT DISTINCT LIST.ROOTID,\n           NVL(LIST.CUSIP, INTEX.CUSIP) AS CUSIP,\n           NVL(LIST.ISIN, INTEX.ISIN) AS ISIN,\n           REGEXP_SUBSTR(INFO.BBG, '^([A-Z0-9]+) ([A-Z0-9-]+) ([A-Z0-9-]+)$', 1, 1, 'i', 1) AS SHELF,\n           REGEXP_SUBSTR(INFO.BBG, '^([A-Z0-9]+) ([A-Z0-9-]+) ([A-Z0-9-]+)$', 1, 1, 'i', 2) AS SERIES,\n           REGEXP_SUBSTR(INFO.BBG, '^([A-Z0-9]+) ([A-Z0-9-]+) ([A-Z0-9-]+)$', 1, 1, 'i', 3) AS CLASS\n    FROM (\n        SELECT CONNECT_BY_ROOT ORIGID AS ROOTID,\n               CASE DUPLICATETYPE\n                   WHEN 'CUSIP' THEN DUPLICATEDID\n                   ELSE ''\n               END AS CUSIP,\n               CASE DUPLICATETYPE\n                   WHEN 'ISIN' THEN DUPLICATEDID\n                   ELSE ''\n               END AS ISIN\n        FROM IDENTIFIERMAPPINGS\n        START WITH ORIGID IN (SELECT SEC_ID FROM SEC_MASTER)\n        CONNECT BY NOCYCLE ORIGID = PRIOR DUPLICATEDID\n\n        UNION\n\n        SELECT SEC_ID AS ROOTID,\n               CASE SEC_ID_TYPE\n                   WHEN 'CUSIP' THEN SEC_ID\n                   ELSE ''\n               END AS CUSIP,\n               CASE SEC_ID_TYPE\n                   WHEN 'ISIN' THEN SEC_ID\n                   ELSE ''\n               END AS ISIN\n        FROM SEC_MASTER\n    ) LIST\n    LEFT JOIN INTEXBONDINFO INTEX\n        ON INTEX.CUSIP = LIST.ROOTID\n    LEFT JOIN (\n        SELECT SEC_ID, FIELD_VALUE AS BBG\n        FROM SEC_MASTER\n        WHERE FIELD_NAME = 'MkTicker'\n    ) INFO\n        ON INFO.SEC_ID = LIST.ROOTID\n),\nTAINTED_COLOR AS (\n    SELECT QUOTES.ROWID AS QUOTEID,\n           QUOTES.MESSAGE_ID,\n           QUOTES.CONTRIBUTOR,\n           QUOTES.OWNER,\n           QUOTES.PRICE_BID,\n           QUOTES.PRICE_ASK,\n           QUOTES.SPREAD_BID,\n           QUOTES.SPREAD_ASK,\n           QUOTES.BENCHMARK,\n           QUOTES.WAL,\n           QUOTES.PRICELEVEL,\n           QUOTES.CONFIDENCE,\n           CLO_LIST.ROOTID AS ROOT_CUSIP,\n           QUOTES.CUSIP,\n           QUOTES.ISIN,\n           QUOTES.SHELF,\n           QUOTES.SERIES,\n           QUOTES.CLASS,\n           NVL(QUOTES.BIAS, NVL2(QUOTES.PRICE_BID, 'BID', 'OFFER')) AS BIAS,\n           CASE\n               WHEN QUOTES.CONTRIBUTOR IN ('Aurul') THEN 1\n               ELSE 0\n           END AS TAINTED,\n           QUOTES.TIME,\n           TRUNC(QUOTES.TIME) AS MKT_DATE,\n           NVL(QUOTES.PRICE_BID, QUOTES.PRICE_ASK) AS PRICE\n    FROM SF_QUOTES_ABS QUOTES\n    RIGHT JOIN CLO_LIST\n        ON CLO_LIST.CUSIP = QUOTES.CUSIP\n        OR CLO_LIST.ISIN = QUOTES.ISIN\n        OR (CLO_LIST.SHELF = QUOTES.SHELF\n            AND CLO_LIST.SERIES = QUOTES.SERIES\n            AND CLO_LIST.CLASS = QUOTES.CLASS)\n    WHERE QUOTES.OWNER <> 'DEMO'\n        AND QUOTES.TIME >= TRUNC(SYSDATE) - 1\n        AND (QUOTES.PRICE_BID IS NOT NULL OR QUOTES.PRICE_ASK IS NOT NULL)\n        AND QUOTES.CONTRIBUTOR NOT IN ('noreply@solveadvisors.com', 'State Street ETF Group')\n),\nFILTERED_COLOR AS (\n    SELECT *\n    FROM (\n        SELECT COLOR.*,\n               ROW_NUMBER() OVER (\n                   PARTITION BY\n                       COLOR.ROOT_CUSIP,\n                       COLOR.CUSIP,\n                       COLOR.ISIN,\n                       COLOR.SHELF,\n                       COLOR.SERIES,\n                       COLOR.CLASS,\n                       COLOR.BIAS,\n                       COLOR.PRICE_BID,\n                       COLOR.PRICE_ASK,\n                       COLOR.PRICELEVEL,\n                       COLOR.CONFIDENCE,\n                       COLOR.MKT_DATE\n                   ORDER BY COLOR.TIME ASC\n               ) AS RECENT\n        FROM (\n            SELECT TAINTED_COLOR.QUOTEID,\n                   TAINTED_COLOR.MESSAGE_ID,\n                   TAINTED_COLOR.CONTRIBUTOR,\n                   TAINTED_COLOR.OWNER,\n                   TAINTED_COLOR.PRICE_BID,\n                   TAINTED_COLOR.PRICE_ASK,\n                   TAINTED_COLOR.SPREAD_BID,\n                   TAINTED_COLOR.SPREAD_ASK,\n                   TAINTED_COLOR.BENCHMARK,\n                   TAINTED_COLOR.WAL,\n                   TAINTED_COLOR.PRICELEVEL,\n                   TAINTED_COLOR.CONFIDENCE,\n                   TAINTED_COLOR.ROOT_CUSIP,\n                   TAINTED_COLOR.CUSIP,\n                   TAINTED_COLOR.ISIN,\n                   TAINTED_COLOR.SHELF,\n                   TAINTED_COLOR.SERIES,\n                   TAINTED_COLOR.CLASS,\n                   TAINTED_COLOR.BIAS,\n                   TAINTED_COLOR.TAINTED,\n                   TAINTED_COLOR.TIME,\n                   TAINTED_COLOR.MKT_DATE,\n                   TAINTED_COLOR.PRICE\n            FROM TAINTED_COLOR\n        ) COLOR\n    ) COLOR\n    WHERE COLOR.RECENT = 1\n),\n\nCOLOUR AS (\n    SELECT SYSDATE AS TIME_QUERIED,\n           COLOR.TIME AS TIME_RECEIVED,\n           TO_CHAR(COLOR.MESSAGE_ID) AS MESSAGE,\n           COLOR.ROOT_CUSIP,\n           COLOR.CUSIP AS CUSIP_COLOR,\n           COLOR.ISIN AS ISIN_COLOR,\n           COLOR.SHELF || ' ' || COLOR.SERIES || ' ' || COLOR.CLASS AS TICKER,\n           NVL(RTG.FIELD_VALUE, '100') AS ORIG_BEST_RATING,\n           NVL(CURR.FIELD_VALUE, '') AS CURRENCY,\n           COLOR.PRICE_BID,\n           COLOR.PRICE_ASK,\n           COLOR.SPREAD_BID,\n           COLOR.SPREAD_ASK,\n           COLOR.BENCHMARK,\n           COLOR.WAL,\n           COLOR.PRICELEVEL,\n           DECODE(\n               COLOR.BIAS,\n               'MARKET', 'BID',\n               'BUYER', 'BID',\n               NULL, NVL2(COLOR.PRICE_BID, 'BID', 'OFFER'),\n               COLOR.BIAS\n           ) AS BIAS,\n           COLOR.CONTRIBUTOR,\n           COLOR.OWNER,\n           NVL(COLOR.PRICE_BID, COLOR.PRICE_ASK) AS PRICE,\n           COLOR.CONFIDENCE,\n           COLOR.QUOTEID,\n           NVL(ch.PRICEMID, ch.PRICEBID) AS COV_PRICE\n    FROM FILTERED_COLOR COLOR\n    LEFT JOIN SEC_MASTER RTG\n        ON RTG.SEC_ID = COLOR.ROOT_CUSIP\n        AND RTG.FIELD_NAME = 'OriginalBestRatingScore'\n    LEFT JOIN SEC_MASTER CURR\n        ON CURR.SEC_ID = COLOR.ROOT_CUSIP\n        AND CURR.FIELD_NAME = 'Currency'\n    LEFT JOIN coveragehist ch\n        ON COLOR.ROOT_CUSIP = ch.cusip\n        AND ch.ASOF >= TRUNC(SYSDATE) - 1\n        AND ch.PUBLISHEDBATCH = 'N1600'\n),\nACCEPTED AS (\n    SELECT COLOUR.ROOT_CUSIP,\n           sm.prc_config_key_name,\n           CASE\n               WHEN COLOUR.PRICE > 105 AND sm.prc_config_key_name IN ('1.0_Mezz', '2.0_Mezz', '2.0_Senior') THEN 1\n               WHEN COLOUR.PRICE < 10 AND sm.prc_config_key_name IN ('1.0_Mezz', '2.0_Mezz', '2.0_Senior') THEN 1\n               ELSE 0\n           END AS REJECTED\n    FROM COLOUR\n    JOIN SECURITY_MASTER sm\n        ON COLOUR.ROOT_CUSIP = sm.SEC_ID\n    WHERE sm.SEC_STATUS = 'Approved'\n        AND sm.PRC_CONFIG_SEC_TYPE = 'CLO'\n)\nSELECT DISTINCT\n    TO_CHAR(col.MESSAGE) AS MESSAGE_ID,\n    col.TICKER,\n    a.prc_config_key_name AS Sector,\n    col.ROOT_CUSIP AS CUSIP,\n    TRUNC(SYSDATE) AS \"DATE\",\n    NVL(col.PRICE, 0) AS PRICE_LEVEL,\n    NVL(col.PRICE_BID, 0) AS Bid,\n    NVL(col.PRICE_ASK, 0) AS Ask,\n    NVL(col.PRICE, 0) AS Px,\n    col.CONTRIBUTOR AS SOURCE,\n    col.BIAS,\n\n    DECODE(\n        col.BIAS,\n        'TRADE CONFIRM', 1,\n        'BWIC COVER', 2,\n        'BWIC REO', 3,\n        'MARKET', 3,\n        'BUYER', 3,\n        'BID', 3,\n        'COLOR', 3,\n        'OFFER', 4,\n        'BWIC TALK', 5,\n        'VALUATION', 6,\n        'DNT', 3,\n        'DNT BEST', 3\n\n    ) AS RANK,\n\n    col.COV_PRICE,\n\n    CASE\n        WHEN col.COV_PRICE IS NOT NULL AND col.COV_PRICE <> 0 THEN\n            ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / col.COV_PRICE) * 100), 2)\n        ELSE NULL\n    END AS PERCENT_DIFF,\n\n    (NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) AS PRICE_DIFF,\n\n    col.CONFIDENCE,\n    TRUNC(col.TIME_RECEIVED) AS DATE_1,\n\n    CASE\n        WHEN a.prc_config_key_name IN ('2.0_AAA_Mez', '2.0_AAA_Senior', '2.0_AAA_X_Senior') THEN\n            CASE\n                WHEN ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / col.COV_PRICE) * 100), 2) > 2 THEN 'Significant Difference'\n                ELSE 'Small Difference'\n            END\n        WHEN a.prc_config_key_name IN ('2.0_Mezz', '2.0_Senior', 'A_BSL', 'COMBO', 'Equity_Eur', 'European', 'European_Yield') THEN\n            CASE\n                WHEN ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / col.COV_PRICE) * 100), 2) > 2 THEN 'Significant Difference'\n                ELSE 'Small Difference'\n            END\n        WHEN a.prc_config_key_name IN ('US_Equity_2.0', 'US_MM_Equity_2.0') THEN\n            CASE\n                WHEN ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / col.COV_PRICE) * 100), 2) > 5 THEN 'Significant Difference'\n                ELSE 'Small Difference'\n            END\n        WHEN a.prc_config_key_name = 'US_Re' THEN\n            CASE\n                WHEN ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / col.COV_PRICE) * 100), 2) > 2 THEN 'Significant Difference'\n                ELSE 'Small Difference'\n            END\n        ELSE\n            CASE\n                WHEN ROUND(ABS(((NVL(col.PRICE, 0) - NVL(col.COV_PRICE, 0)) / NULLIF(NVL(col.COV_PRICE, 0), 0)) * 100), 2) > 2 THEN 'Significant Difference'\n                ELSE 'Small Difference'\n            END\n    END AS DIFF_STATUS\n\nFROM COLOUR col\nJOIN ACCEPTED a\n    ON col.ROOT_CUSIP = a.ROOT_CUSIP\nWHERE a.REJECTED = 0\n    AND col.CURRENCY = 'USD'\n\nORDER BY\n    a.prc_config_key_name,\n    col.ROOT_CUSIP,\n    DATE_1 DESC,\n    RANK,\n    NVL(col.PRICE, 0) DESC;\n",
    "query_name": "base_query",
    "query_updated_at": "2026-02-03T01:48:16.019665"
  }
}